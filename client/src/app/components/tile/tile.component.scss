// Variables
$tile-border-radius: 4px;
$tile-transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
$hover-brightness: 1.05;
$active-brightness: 0.95;
$item-size: 80%;
$animation-duration: 500ms;
$bounce-timing: cubic-bezier(0.34, 1.56, 0.64, 1);
$ease-out-timing: cubic-bezier(0.4, 0, 0.2, 1);

.tile {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
    cursor: pointer;
    border-radius: $tile-border-radius;
    user-select: none;
    transition: transform $tile-transition;

    &::before {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at center, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
        opacity: 0;
        transition: opacity $tile-transition;
        pointer-events: none;
        z-index: 2;
    }

    &:hover {
        &::before {
            opacity: 1;
        }

        .tile-background {
            filter: brightness($hover-brightness);
        }

        .tile-item img {
            transform: scale(1.1);
        }
    }

    &:active {
        transform: scale(0.98);

        .tile-background {
            filter: brightness($active-brightness);
        }

        .tile-item img {
            transform: scale(0.9);
        }
    }

    &.drag-over {
        background-color: rgba(0, 0, 0, 0.1);
    }

    .tile-background {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 0;
        transition: filter $tile-transition;
        will-change: filter;
        image-rendering: pixelated;
    }

    .tile-item {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1;
        will-change: transform, opacity;
        transform-origin: center center;

        &.placing {
            animation: placeItem $animation-duration $bounce-timing forwards;
        }

        &.dragging {
            animation: dragStart 0.2s $ease-out-timing forwards;
        }

        img {
            width: 80%;
            height: 80%;
            object-fit: contain;
            cursor: move;
            transition: transform 0.2s ease;
            will-change: transform;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));

            &:hover {
                transform: scale(1.1);
            }
        }
    }
}

// Drag and drop visual feedback
.tile.drag-over {
    &::before {
        opacity: 1;
        background: radial-gradient(circle at center, rgba(66, 153, 225, 0.2) 0%, transparent 70%);
    }

    .tile-background {
        filter: brightness(1.1);
    }
}

// Animations
@keyframes placeItem {
    0% {
        transform: scale(0) rotate(-15deg);
        opacity: 0;
    }
    50% {
        transform: scale(1.2) rotate(5deg);
        opacity: 0.8;
    }
    75% {
        transform: scale(0.95) rotate(-2deg);
        opacity: 0.9;
    }
    100% {
        transform: scale(1) rotate(0);
        opacity: 1;
    }
}

@keyframes dragStart {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    100% {
        transform: scale(0.8) translateY(20px);
        opacity: 0;
    }
}

// Animation for item appearance
.tile-item {
    &.placing {
        animation: placeItem $animation-duration $bounce-timing forwards;
    }

    &.dragging {
        animation: dragStart 0.2s $ease-out-timing forwards;
    }
}
